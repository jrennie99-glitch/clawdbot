services:
  moltbot-gateway:
    image: moltbot/moltbot:latest
    environment:
      HOME: /home/node
      TERM: xterm-256color
      CLAWDBOT_GATEWAY_TOKEN: ${CLAWDBOT_GATEWAY_TOKEN:-default-token-change-me}
      CLAWDBOT_GATEWAY_PORT: 8001
      CLAWDBOT_GATEWAY_BIND: 0.0.0.0
      NODE_ENV: production
    volumes:
      - clawdbot-config:/home/node/.clawdbot
      - clawdbot-workspace:/home/node/clawd
    ports:
      - "8001:8001"
      - "3002:3000"
    init: true
    restart: unless-stopped
    command:
      - "node"
      - "dist/index.js"
      - "gateway"
      - "--bind"
      - "0.0.0.0"
      - "--port"
      - "8001"
      - "--allow-unconfigured"

  moltbot-ui:
    image: moltbot/moltbot:latest
    environment:
      HOME: /home/node
      PORT: 3000
      GATEWAY_PORT: 8001
      NODE_ENV: production
    ports:
      - "3000:3000"
    init: true
    restart: unless-stopped
    command:
      - "sh"
      - "-c"
      - "sleep 5 && node serve-ui.mjs"
    depends_on:
      - moltbot-gateway

volumes:
  clawdbot-config:
  clawdbot-workspace:
